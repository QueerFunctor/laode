\documentclass{ximera}

\input{../preamble.tex}

\title{*Phase Portraits of Nonhyperbolic Systems}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

 \label{S:6.9}

A linear constant coefficient system $\dot{X}=CX$ is not hyperbolic
\index{nonhyperbolic}
when either $C$ has a zero eigenvalue ($\det(C)=0$) or when $C$ has
purely imaginary eigenvalues ($\det(C)>0$ and $\trace(C)=0$).  These
special cases are indicated by bold lines in Figure~\ref{F:td}.

There are four types of nonhyperbolic planar systems.  There are:
\begin{enumerate}
\item	the {\em center}\index{center} --- nonzero purely imaginary
eigenvalues,
\item	the {\em saddle-node\/}\index{saddle-node} --- a single
zero eigenvalue,
\item	the {\em shear\/}\index{shear} --- a double zero eigenvalue;
one  independent eigenvector, and
\item	the zero matrix itself.
\end{enumerate}
The dynamics in the last case are very easy to describe --- all solutions
are equilibria and solutions remain at the initial point for all time.

\subsubsection*{Centers}

There is a new kind of solution that occurs only in centers --- the time
periodic solution\index{periodic solution} --- as we now explain.
In Chapter~\ref{Chap:Planar},
Theorem~\ref{T:putinform} we showed that when the $2\times 2$
matrix $C$ has purely eigenvalues $\pm i\tau$ with $\tau\neq 0$, then $C$
is similar to the matrix
\[
B =   \mattwo{0}{-\tau}{\tau}{0}.
\]
In Table~\ref{T:3sys}(b) we showed that solutions to $\dot{X}=BX$ are
\[
X(t) = \mattwo{\cos(\tau t)}{-\sin(\tau t)}{\sin(\tau t)}{\cos(\tau t)}X_0
=R_{\tau t}X_0,
\]
where $X_0$ is the vector of initial conditions and $R_{\tau t}$ is a
rotation matrix (recall \eqref{e:rotmat} of Chapter~\ref{chap:matrices}).

Note that every solution to $\dot{X}=BX$ traverses a circle around the
origin as $R_{\tau t}$ rotates the plane counterclockwise through the angle
$\tau t$.  As an example, we graph\index{phase!portrait!for a center}
a solution to $\dot{X}=BX$ and its time
series in Figure~\ref{F:center} when $\tau=3$.  All centers have nonzero
trajectories that are either ellipses\index{ellipse} or circles, and
those centers that do
not have the form of $B$ typically produce ellipses as solutions.  See
Exercise~\ref{E:notcircles}.

\begin{figure*}[htb]
     \centerline{%
     \psfig{file=../figures/center.eps,width=2.2in}
     \psfig{file=../figures/centerts.eps,width=2.2in}}
     \caption{(Left) Solutions to $\dot{X}=BX$ for $\tau=3$.
	(Right) Time series of a solution illustrating time periodicity.}
     \label{F:center}
\end{figure*}

It is instructive to see how solutions change when the real part of the
eigenvalue traverses through zero.  Suppose that $C$ has eigenvalues
$\sigma\pm i\tau$ and is in normal form
\[
C = \mattwo{\sigma}{-\tau}{\tau}{\sigma}.
\]
We illustrate this change by graphing the time series (of both $x$ and $y$
versus $t$) in Figure~\ref{F:spiraling} with $\tau=3$ and $\sigma=-1,0,1$,
respectively. Note that when $\sigma<0$ the time series oscillate about zero
but also damp down to zero, while when $\sigma>0$ the time series oscillate
and diverge.  When $\sigma = 0$, there is an exact balance leading to time
periodic solutions.

\begin{figure*}[htb]
     \centerline{%
     \psfig{file=../figures/spn1.eps,width=2.2in}
     \psfig{file=../figures/sp0.eps,width=2.2in}
     \psfig{file=../figures/sp1.eps,width=2.2in}}
     \caption{Solutions of $\dot{X}=BX$ for $\tau=3$ and $\sigma=-1,0,1$.}
     \label{F:spiraling}
\end{figure*}

\subsubsection*{Saddle Nodes}

When the determinant of a matrix $C$ is zero, then $C$ must have a zero
eigenvalue.  The simplest way for $\det(C)$ to be zero is for $C$ to have a
single zero eigenvalue.  In this case we call the origin a {\em saddle node}.

So the eigenvalues of a saddle node are $\lambda_1=0$ and $\lambda_2\neq 0$.
For simplicity of discussion, we assume that $\lambda_2<0$.  Let $v_1$ and
$v_2$ be the associated eigenvectors.  Since $Cv_1=0$, it follows that saddle
nodes have a line of equilibria\index{line of equilibria}
$X(t)=\alpha_1v_1$ for every scalar $\alpha_1$.

There is also a solution $X(t)=e^{\lambda_2 t}v_2$ that converges to the
origin in forward time (since $\lambda_2<0$).  The general solution to this
system is
\[
X(t) = \alpha_1 v_1 + \alpha_2 e^{\lambda_2 t}v_2,
\]
for scalars $\alpha_1$ and $\alpha_2$.  Since $\lambda_2<0$ this solution
converges on the equilibrium $\alpha_1 v_1$ in forward time.  Moreover,
the trajectory for any solution stays for all time on the line parallel
to the vector $v_2$.  The phase portrait\index{phase!portrait!for a saddle
node}
for the system
\begin{equation}  \label{e:10ev}
\frac{dX}{dt} = \mattwo{-2}{4}{1}{-2} X
\end{equation}
is shown in Figure~\ref{F:10ev} (left) along with the time series
of a solution (right).  Note how the time series (of $x$ versus $t$)
asymptotes onto the $x$ coordinate of an equilibrium.

\begin{figure*}[htb]
     \centerline{%
     \psfig{file=../figures/z1ev.eps,width=2.2in}
     \psfig{file=../figures/z1evts.eps,width=2.2in}}
     \caption{(Left) Phase portrait of \protect\eqref{e:10ev}.
	(Right) Time series of a solution.}
     \label{F:10ev}
\end{figure*}

The saddle-node\index{saddle-node} is a
nonhyperbolic equilibrium\index{equilibrium!nonhyperbolic}
that sits between
the hyperbolic saddle and the hyperbolic node (either the nodal
sink or the nodal source), just as the center\index{center} sits
between the hyperbolic spiral source and the hyperbolic spiral sink.  To
illustrate this point we show three time series in
Figure~\ref{F:saddlenodebif} for the system
\begin{equation}  \label{e:saddlenodebif}
\frac{dX}{dt}  =  \mattwo{\mu}{0}{0}{-1}X
\end{equation}
when $\mu<0$, $\mu=0$, and $\mu>0$.  See how the $y$ time series
decays exponentially to zero in forward time in each case.  But
the $x$ time series converges to zero when $\mu<0$ and grows
exponentially when $\mu>0$.  Finally, when $\mu=0$ the $x$ time
series is constant.

\begin{figure*}[htb]
     \centerline{%
     \psfig{file=../figures/snn1.eps,width=2.2in}
     \psfig{file=../figures/sn0.eps,width=2.2in}
     \psfig{file=../figures/snp1.eps,width=2.2in}}
     \caption{Time series for solutions of \protect\eqref{e:saddlenodebif}
	when $\mu=-0.2,0,0.2$.}
     \label{F:saddlenodebif}
\end{figure*}


\subsubsection*{Shears}
\index{shear}

The last example of a nonhyperbolic system occurs when the matrix $C$
has two zero eigenvalues --- but only one linearly independent
eigenvector.  In this case we call the origin a {\em shear\/}.  After a
similarity transformation such a system is
\begin{equation}  \label{e:00}
\frac{dX}{dt} = \mattwo{0}{1}{0}{0} X
\end{equation}
The solution is
\[
(x(t),y(t)) = (x_0+y_0t,y_0).
\]
Thus solutions move along lines parallel to the $x$ axis through
the point $(x_0,y_0)$ with speed $y_0$.  These trajectories move
to the right when $y_0>0$ and to the left when $y_0<0$.

\EXER

\TEXER

\noindent In Exercises~\ref{c6.9.1a} -- \ref{c6.9.1b}, find a $2\times 2$
matrix $C$ so that the differential equation $\dot{X}=CX$ satisfies the
given condition.
\begin{exercise} \label{c6.9.1a}
The origin is a center.

\begin{solution}
\ans One such matrix is $C = \mattwo{0}{-1}{1}{0}$.

\soln More generally, for any matrix
\[
C = \mattwo{\sigma}{-\tau}{\tau}{\sigma}
\]
such that $\sigma = 0$ and $\tau \neq 0$, the differential equation
$\dot{X} = CX$ will have the origin as a center.

\end{solution}
\end{exercise}
\begin{exercise} \label{c6.9.1b}
The origin is a saddle-node with equilibria on the line generated by the
vector $(-1,2)$.

\begin{solution}
\ans One such matrix is $C = \mattwo{0}{0}{2}{1}$.

\soln Saddle nodes are generated by systems with eigenvalues $\lambda_1
= 0$ and $\lambda_2 \neq 0$.  All trajectories converge on the
eigenvector associated to eigenvalue $0$, so $v_1 = (-1,2)$ is the
eigenvector associated to $\lambda_1$.  Let $v_2 = (0,1)$ be the
eigenvector associated to $\lambda_2$, and let $\lambda_2 = 1$.  Then,
according to Theorem~\ref{T:putinform}, $C
= PDP^{-1}$, where $D$ is the diagonal matrix will $\lambda_1$ and
$\lambda_2$ along the main diagonal, and $P = (v_1|v_2)$.  Thus,
\[
C = \mattwo{-1}{0}{2}{1}\mattwo{0}{0}{0}{1}\mattwo{-1}{0}{2}{1}
= \mattwo{0}{0}{2}{1}.
\]

\end{solution}
\end{exercise}

\begin{exercise} \label{c6.9.2}
Recall from Chapter~\ref{Chap:Planar}, \eqref{ex:uspring} that the undamped
spring equation is $\frac{d^2x}{dt^2} + \kappa x = 0$, where $\kappa>0$.
\begin{itemize}
\item[(a)]   As a first order system this equation is:
\begin{eqnarray*}
\dot{x} & = & y \\
\dot{y} & = & -\kappa x.
\end{eqnarray*}
Sketch the phase portrait of this equation.
\item[(b)]  The damped spring equation, written as a first order system, is:
\begin{eqnarray*}
\dot{x} & = & y \\
\dot{y} & = & -\kappa x-\sigma y,
\end{eqnarray*}
where $\sigma>0$ is the damping.  Sketch the phase portrait of this equation.
\end{itemize}

\begin{solution}

Three trajectories of the undamped equation are shown in Figure~\ref{c6.9.2}a,
and one trajectory of the damped equation is shown in Figure~\ref{c6.9.2}b.

%(a) \ans The first order linear system corresponding to \eqref{ex:uspring} is
%\[ \begin{array}{rcl}
%\dot{x} & = & y \\
%\dot{y} & = & -\kappa x. \end{array}
%\]
%\soln  The equation \eqref{ex:uspring} is a special case of \eqref{E:2ndorder}
%in which $a(x) = 0$ and $b(x) = \kappa$.

%(b) \ans The damped first order linear system is
%\[ \begin{array}{rcl}
%\dot{x} & = & y \\
%\dot{y} & = & -\kappa x -\sigma y. \end{array}
%\]
%\soln When friction is taken into account, the second order
%differential equation is
%\[ \frac{d^2x}{dt^2} + \sigma\frac{dx}{dt} + \kappa x = 0, \]
%which is also a special case of \eqref{E:2ndorder}.  In this case,
%$a(x) = \sigma$ and $b(x) = \kappa$.

%(c) The three sample trajectories for the solution to the
%frictionless system (Figure \ref{c3.5.6}a) are ellipses
%around the origin.  This makes sense, since $|x|$ (the distance
%of the spring from its natural position) is at a maximum when
%$|y|$ (the speed of the spring's motion) is $0$.  The sample
%trajectory for the damped system (Figure \ref{c3.5.6}b) 
%is a spiral, since friction
%both slows the spring and shortens the distance of motion until
%the spring comes to rest at its natural length.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/3-5-6a.eps,width=2.75in}
                       \psfig{file=exfigure/3-5-6b.eps,width=2.75in}}
			\exercaptwo{c6.9.2}
\end{figure}

\end{solution}
\end{exercise}

\noindent In Exercises~\ref{E:PPa} -- \ref{E:PPe}, consider the four pictures
in Figure~\ref{F:PP}.  Each picture is a phase portrait of a system of
differential equations $\dot{X}=CX$ where $C$ is a $2\times 2$ matrix.  Answer
the given question for each of these phase portraits.
\begin{exercise}  \label{E:PPa}
What is the name of the type of equilibrium at the origin?

\begin{solution}
\ans System $A$ has a spiral sink at the origin, $B$ has a
saddle, $C$ has a saddle node, and $D$ has an improper nodal source.

\soln Answers can be determined visually using the graphs and examples
from Sections~\ref{S:PlanarSystems} and \ref{S:6.9} of the text.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PPb}
Is the origin asymptotically stable?

\begin{solution}
\ans The origin is asymptotically stable for $A$ and unstable
for $B$, $C$ and $D$.

\soln The origin is asymptotically stable if all solutions tend towards
the origin as $t \rightarrow \infty$.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PPc}
Is ${\rm trace}(C)$ positive, negative, or zero?

\begin{solution}
\ans The traces of $A$, $B$ and $C$ are negative, and the
trace of $D$ is positive.

\soln The trace of a matrix is the sum of the eigenvalues, so the trace
is positive for sources, which have two positive eigenvalues and
negative for sinks, which have two negative eigenvalues.  The trajectories
of $C$ approach the eigenvector of $0$ as $t$ increases, rather
than tending away from it, so the nonzero eigenvector is negative and,
therefore, the trace is also negative.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PPd}
Is $\det(C)$ positive, negative, or zero?

\begin{solution}
\ans The determinants of $A$ and $D$ are positive, the
determinant of $B$ is negative, and the determinant of $C$ is zero.

\soln The determinant of a matrix is the product of the eigenvectors.  The
eigenvectors of $A$ are complex conjugates, so their product
is positive.  A saddle has one negative and one positive eigenvector, so
the determinant of $B$ is negative.  A saddle node has one zero
eigenvector, so the product of the eigenvectors of $C$ is zero.  An
improper nodal source has equal positive eigenvectors, so the determinant
of $D$ is positive.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PPe}
Is ${\rm discriminant}(C)$ positive, negative, or zero?

\begin{solution}
\ans The discriminant of $A$ is negative, the discriminants of
$B$ and $C$ are positive, and the discriminant of $D$ is zero.

\soln The discriminant of a matrix is negative when the eigenvalues are
a complex conjugate pair, positive when the eigenvalues are real, and
zero when the eigenvalues are equal.

\end{solution}
\end{exercise}

\begin{figure*}[htb]
\centerline{(A) \hspace{2.7in} (B)}
           \centerline{%
           \psfig{file=../figures/e2B.eps,width=3.0in}
           \psfig{file=../figures/e2C.eps,width=3.0in}}
\centerline{(C) \hspace{2.7in} (D)}
           \centerline{%
           \psfig{file=../figures/e2A.eps,width=3.0in}
           \psfig{file=../figures/e2D.eps,width=3.0in}}
\caption{Phase portraits for planar linear systems in
Exercises~\protect\ref{E:PPa} -- \protect\ref{E:PPe}}
\label{F:PP}
\end{figure*}

\noindent In Exercises~\ref{E:PQa} -- \ref{E:PQg}, consider the system of
differential equations $\dot{X}=CX$ where $C$ is the given matrix.  For each
system determine whether the origin is hyperbolic or not and the type of
equilibrium at the origin (spiral sink, center, etc.).
\begin{exercise}  \label{E:PQa}
$C = \mattwo{1}{-1}{2}{1}$.

\begin{solution}
\ans The origin is hyperbolic, and the equilibrium at the origin
is a spiral source.

\soln The trace and determinant of $C$ are both nonzero, so the origin
is hyperbolic.  Since $\det(C) = 3 > 0$ and $\trace(C) = 2 > 0$,
the equilibrium at the origin is a source.  Since the discriminant
$D \equiv \trace(C)^2 - 4\det(C) = -8 < 0$, the origin is a spiral.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQb}
$C = \mattwo{1}{1}{-1}{1}$.

\begin{solution}
\ans The origin is hyperbolic, and the equilibrium at the origin
is a spiral source.

\soln The trace and determinant of $C$ are both nonzero, so the origin
is hyperbolic.  Since $\det(C) = 2 > 0$ and $\trace(C) = 2 > 0$,
the equilibrium at the origin is a source.  Since the discriminant
$D \equiv \trace(C)^2 - 4\det(C) = -4 < 0$, the origin is a spiral.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQc}
$C = \mattwo{3}{-1}{1}{1}$.

\begin{solution}
\ans The origin is hyperbolic, and the equilibrium at the origin
is an improper nodal source.

\soln The trace and determinant of $C$ are both nonzero, so the origin
is hyperbolic.  Since $\det(C) = 4 > 0$ and $\trace(C) = 4 > 0$,
the equilibrium at the origin is a source.  Since the discriminant
$D \equiv \trace(C)^2 - 4\det(C) = 0$, the eigenvalues of $C$ are equal.
Since $C$ is not a multiple of $I_2$, $C$ has only one eigenvector, so
the origin is an improper node.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQd}
$C = \mattwo{1}{1}{1}{1}$.

\begin{solution}
\ans The origin is not hyperbolic, and the equilibrium at
the origin is a saddle node.

\soln The determinant of $C$ is zero, so the origin is not hyperbolic.
Since $\trace(C) = 2 \neq 0$, $C$ has one zero eigenvalue and one
nonzero eigenvalue, so the equilibrium at the origin is a saddle node.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQe}
$C = \mattwo{2}{-2}{4}{-2}$.

\begin{solution}
\ans The origin is not hyperbolic, and the equilibrium at
the origin is a center.

\soln Since $\det(C) = 4 > 0$ and $\trace(C) = 0$, the origin is not
hyperbolic and $C$ has purely imaginary eigenvalues.  Thus, the
equilibrium at the origin is a center.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQf}
$C = \mattwo{2}{2}{-2}{-2}$.

\begin{solution}
\ans The origin is not hyperbolic, and the equilibrium at
the origin is a shear.

\soln The trace and determinant of $C$ are both zero, so the origin
is not hyperbolic.  Since $C$ is not the zero matrix, the equilibrium
at the origin is a shear.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:PQg}
$C = \mattwo{1}{1}{4}{1}$.

\begin{solution}
\ans The origin is hyperbolic, and the equilibrium at the origin
is a saddle.

\soln The trace and determinant of $C$ are both nonzero, so the origin
is hyperbolic.  Since $\det(C) = -3 < 0$, the equilibrium at the origin 
is a saddle.

\end{solution}
\end{exercise}

\CEXER

\begin{exercise}  \label{E:notcircles}
Consider the system of differential equations $\dot{X}=CX$ where
$C=\mattwo{2}{-10}{1}{-2}$.  By hand show that this system is a center and
use {\pplane} to determine its phase portrait.  Describe both the
similarities and the differences of the phase portrait of this system
and the phase portrait in Figure~\ref{F:center}.

\begin{solution}

By definition, a system $\dot{X} = CX$ is a center if the eigenvalues
of $C$ are purely imaginary.  This occurs when $\det(C) > 0$ and
$\trace(C) = 0$.  In this case, $\det(C) = 6$ and $\trace(C) = 0$, so
the system is indeed a center.  The phase portrait is shown in
Figure~\ref{E:notcircles}.  In this phase portrait and in the one
shown in Figure~\ref{F:center}, all
trajectories are closed ellipses.  However, the trajectories in
Figure~\ref{F:center} are circular, while the ones in this exercise
are not.  This is true because Figure~\ref{F:center} graphs the system
$\dot{X} = BX$, where
\[ B = \mattwo{0}{-\tau}{\tau}{0}, \]
while this problem graphs the system $\dot{X} = CX$, where $C = 
PBP^{-1}$ and $P \neq I_2$.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/notcircles.eps,width=3.0in}}
                \exercap{E:notcircles}
\end{figure}

\end{solution}
\end{exercise}

\begin{exercise} \label{c6.9.5}
Consider the system of differential equations $\dot{X}=CX$ where
$C=\mattwo{2}{-4}{1}{-2}$.  By hand show that this system is a shear and
use {\pplane} to determine its phase portrait.  Describe both the
similarities and the differences of the phase portrait of this system
and the phase portrait of \eqref{e:00}.

\begin{solution}

By definition, a system $\dot{X} = CX$ is a shear if the system has two
zero eigenvalues.  In this case, $\det(C) = 0$ and $\trace(C) = 0$, so
the eigenvalues are $\lambda_1 = \lambda_2 = 0$.  The phase portrait of
this system is shown in Figure~\ref{c6.9.5}a, and the phase portrait of
\eqref{e:00} is shown in Figure~\ref{c6.9.5}b.  In both phase portraits,
all trajectories are straight lines parallel to the eigenvector.  However,
in \ref{c6.9.5}b, the trajectories are parallel to the $x$-axis, whereas
in \ref{c6.9.5}a, they are not.

\begin{figure}[htb]
                       \centerline{%
                       \psfig{file=exfigure/6-9-5a.eps,width=2.75in}
                       \psfig{file=exfigure/6-9-5b.eps,width=2.75in}}
                \exercaptwo{c6.9.5}
\end{figure}







\end{solution}
\end{exercise}

\end{document}
