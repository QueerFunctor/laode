\documentclass{ximera}

\input{../preamble.tex}

\title{Undetermined Coefficients}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle


\label{sec:2norderinhom}

In this section we find solutions to inhomogeneous linear differential 
equations, such as the second order equation
\begin{equation}  \label{e:inhom1}
\ddot{x} + b\dot{x} + ax = g(t),
\end{equation}
where $g(t)$ is thought of as a forcing term\index{forcing!term}.   
To find all solutions to 
the inhomogeneous\index{inhomogeneous} 
equation \eqref{e:inhom1}, we need to find just one solution
to \eqref{e:inhom1} and then add to that solution all solutions to the 
homogeneous equation --- which we know how to solve.  If the forcing term 
$g(t)$ is sufficiently nice, then there is an elegant way to solve 
\eqref{e:inhom1} called the method of 
{\em undetermined coefficients}\index{undetermined coefficients}.


\subsubsection*{An Illustrative Example}

Consider the differential equation
\begin{equation}  \label{eq:undetcoeffex}
\ddot{x} + 3\dot{x}+2x = t.
\end{equation}
To solve \eqref{eq:undetcoeffex} we must find one solution to the inhomogeneous
equation and add to that particular solution\index{particular solution} the 
general solution\index{general solution} of the 
homogeneous equation.  

The general solution to the homogeneous equation is easily found using the
techniques of Section~\ref{sec:HighOrder}.  That is, the characteristic 
polynomial of the homogeneous equation is 
\[
p(\lambda) = \lambda^2 + 3\lambda + 2 = (\lambda+2)(\lambda+1).
\]
So the roots of $p(\lambda)$ are $-2$ and $-1$.  It follows that the general
solution to the homogeneous equation is:
\[
x_h(t)= \alpha_1e^{-2t} + \alpha_2e^{-t}.
\]

Therefore, to solve \eqref{eq:undetcoeffex} in general we must find just one 
solution to \eqref{eq:undetcoeffex}.  Can we guess the answer?  The answer is
yes in this case.  Since differentiation just lowers the degree of a 
polynomial, we can guess that there is a particular solution $x(t)$ to 
\eqref{eq:undetcoeffex} that is a polynomial of degree one, that is, $x(t)$ 
has the form 
\[
y(t)=d_1t+d_2
\]
for constants $d_1$ and $d_2$.  If we substitute $y(t)$ 
into the left hand side of \eqref{eq:undetcoeffex}, we obtain
\[
\left(\frac{d^2}{dt^2}+3\frac{d}{dt}+2\right)y(t) = 
0+3d_1+2(d_1t+d_2) = 2d_1t + (3d_1+2d_2).
\]
Since we want the result of this differentiation to be $t$, we must choose 
$d_1$ and $d_2$ to solve the linear equations
\[
2d_1 = 1 \AND 3d_1+2d_2=0.
\]
The solution to this linear system is $d_1=\frac{1}{2}$ and 
$d_2=-\frac{3}{4}$.   Therefore, we get a 
particular solution\index{particular solution} to 
\eqref{eq:undetcoeffex}, namely, $x_p(t)=\frac{1}{2}t-\frac{3}{4}$.  
It follows that the general solution to \eqref{eq:undetcoeffex} is:
\[
x(t) = x_h(t)+x_p(t) = \alpha_1e^{-2t} + \alpha_2e^{-t} + 
\frac{1}{2}t-\frac{3}{4}.
\]

\subsubsection*{Why did the guess work?}

What lies at the heart of undetermined coefficients is having a method 
for choosing a subspace of functions in which a particular solution resides.  
We call this subspace the {\em trial space}\index{trial!space}.  In example 
\eqref{eq:undetcoeffex} the trial space is the two dimensional subspace
\[
d_1t + d_2.
\]

The idea behind finding a trial subspace is the elimination of the 
inhomogeneity in \eqref{eq:undetcoeffex} using the fact that $g(t)=t$ is 
itself a solution to some homogeneous differential equation.  In example 
\eqref{eq:undetcoeffex}, $g(t)=t$ satisfies the differential equation
\[
\frac{d^2y}{dt^2} = 0.
\]
It follows that any solution $x$ of \eqref{eq:undetcoeffex} has to satisfy
\begin{equation}  \label{e:undetc2}
0 = \frac{d^2}{dt^2}t=\frac{d^2}{dt^2}(\ddot{x} + 3\dot{x}+2x) = 
\frac{d^4x}{dt^4} + 3\frac{d^3x}{dt^3} + 2\frac{d^2x}{dt^2}
\end{equation}
The characteristic 
polynomial\index{characteristic polynomial!of higher order ODE}
of the homogeneous equation 
\eqref{e:undetc2} is: 
\[
\lambda^4 + 3\lambda^3 + 2\lambda^2 = \lambda^2(\lambda+1)(\lambda+2),
\]
and its zeros are
\[
\lambda_1=\lambda_2=0,\quad \lambda_3=-1,\quad \lambda_4 = -2.
\]
Hence, the general solution\index{general solution} of \eqref{e:undetc2} is
\[
x(t) = c_1 + c_2 t + c_3 e^{-t} + c_4 e^{-2t}.
\]

Since we want to find a particular solution\index{particular solution} 
of the inhomogeneous equation, 
we need not consider terms that are solutions of the homogeneous equation. 
That is, we can set $c_3=c_4=0$ and try to find a solution of the form
\[
x(t) = c_1 + c_2 t,
\]
which explains more precisely why our guess of a trial space worked.


\subsection*{The Method of Undetermined Coefficients}

The method used in the previous example works for many differential 
equations.  We use the notation for 
linear differential operators\index{linear!differential operator} 
developed in Section~\ref{S:LDO} to discuss how the previous example 
generalizes to a large family of equations.  In fact, we can find a 
particular solution of the $n^{th}$ order inhomogeneous differential equation 
\begin{equation}  \label{eq:nconst2}
p(D)x = g,
\end{equation}
where $g(t)$ is sufficiently differentiable and 
\[
p(D) = \frac{d^n}{dt^n} + a_{n-1}\frac{d^{n-1}}{dt^{n-1}} + \cdots + 
a_1\frac{d}{dt}+a_0,
\]
as follows.  We divide the process into three steps.

\paragraph{Step 1. Find an annihilator\index{annihilator} of $g(t)$.} 
Find a linear differential operator 
\[
q(D) = D^k + b_{k-1}D^{k-1} + \cdots + b_1D+b_0
\]
such that 
\begin{equation}  \label{eq:undetcoeffb}
q(D)g = 0.
\end{equation}
This differential operator is called the {\em annihilator\/} of $g$. 

\noindent {\bf Remark:}  When $g(t)$ is a linear combination of functions
it is often simpler to solve a separate equation for each function in the 
linear combination, as discussed in Lemma~\ref{L:inhsup}.

It follows that if $x(t)$ is a solution to the 
inhomogeneous\index{inhomogeneous} equation \eqref{eq:nconst2}, then $x(t)$ is 
also a solution to the homogeneous\index{homogeneous} equation 
\begin{equation}  \label{E:prodode}
q(D)p(D)x = q(D)g = 0.
\end{equation}
Note that the roots of the 
characteristic 
polynomial\index{characteristic polynomial!of higher order ODE} 
$pq$ for \eqref{E:prodode}
are just the union of the roots of $p$ and the roots of $q$.  

We could take the trial space\index{trial!space} to 
be the space of solutions to \eqref{E:prodode};
but, in general, that space is too large, as it contains all solutions to the 
homogeneous equation $p(D)x=0$.

\paragraph{Step 2: Find the trial space.} 
Compute the general solution to \eqref{E:prodode} and set to zero 
coefficients of solutions of 
the original homogeneous equation $p(D)x=0$, obtaining a subspace of trial 
functions\index{trial!functions}
\[
y(t)=c_1 y_1(t) + \cdots + c_k y_k(t).
\]
Note that if $p$ and $q$ have no roots in common, then the trial space is 
precisely the general solution of equation \eqref{eq:undetcoeffb}.  If $p$ 
and $q$ have common roots, then the situation is more complicated.  See 
\eqref{E:exer4} for an example.

\paragraph{Step 3: Find the particular solution.} 
\index{particular solution}
Substitute the trial function $y$ into \eqref{eq:nconst2} and find constants 
$c_1,\ldots,c_k$ so that $y$ is a particular solution to \eqref{eq:nconst2}.

\subsubsection*{When Undetermined Coefficients Works}

In fact, it is not always possible to satisfy Step 1.  In Step 1 we may not 
be able to find a constant coefficient homogeneous linear differential 
equation that has $g(t)$ as a solution.  However, Theorem~\ref{thm:HOgen} 
shows that all functions $g(t)$ that are 
linear combination of the functions\index{linear!combination!of functions}
\[
t^je^{\lambda t},\quad t^je^{\sigma t}\sin(\tau t),\quad 
t^je^{\sigma t}\cos(\tau t),
\]
for $j=0,1,\ldots$, are solutions to some homogeneous linear differential 
equation (perhaps of high order).  So we can use 
undetermined coefficients\index{undetermined coefficients} to 
find particular solutions for a large class of possible forcing terms $g$.  
And when this method can be used, it is relatively straightforward to implement.


\subsubsection*{A Second Example}

Consider the differential equation
\begin{equation}  \label{e:undet1}
\ddot x + 2\dot x + 2x = \cos(3t).
\end{equation}
The characteristic polynomial of \eqref{e:undet1} is 
$p(\lambda)=\lambda^2+2\lambda+2$; the associated eigenvalues are 
$\lambda=-1\pm i$.

\paragraph{Step 1.} The function $g(t)=\cos(3t)$ is a solution to the 
differential equation
\begin{equation}  \label{e:undet2}
\ddot y + 9y=0.
\end{equation}
So the differential operator $q(D)=D^2+9$ is an 
annihilator\index{annihilator} of $g(t)=\cos(3t)$. 

\paragraph{Step 2.} The roots of $q(\lambda)$ are $\pm 3i$ and they are 
distinct from those of $p(\lambda)$.  Hence the 
general solution\index{general solution} of \eqref{e:undet2}, 
\begin{equation}   \label{E:undet2}
y(t) = c_1 \cos(3t)+ c_2 \sin(3t),
\end{equation}
is the trial space in which to look for a 
particular solution\index{particular solution} of \eqref{e:undet1}.

\paragraph{Step 3.} Substituting \eqref{E:undet2} into \eqref{e:undet1} yields
\begin{eqnarray*}
-9(c_1\cos(3t)+c_2 \sin(3t)) +6(c_2\cos(3t)-c_1\sin(3t)) & & \\
+2(c_1 \cos(3t)+ c_2 \sin(3t)) &  = & \cos(3t).
\end{eqnarray*}
That is,
\[
(-7c_1+6c_2)\cos(3t)+(-6c_1-7c_2)\sin(3t) = \cos(3t).
\]
Hence we have found a particular solution when the coefficients $c_1$ and 
$c_2$ satisfy 
\begin{eqnarray*}
-7c_1 +6c_2 & = & 1\\
-6c_1 -7c_2 & = & 0.
\end{eqnarray*}
The solution of this system is 
\[
c_1 = -\frac{7}{85},\quad c_2 = \frac{6}{85}.
\]
Thus, 
\[
x_p(t) = \frac{1}{85}(6\sin(3t)-7\cos(3t))
\]
is a particular solution of \eqref{e:undet1}.

\subsubsection*{A Third Example Using Superposition}
\index{principle of superposition}

Find a particular solution of the differential equation
\begin{equation}  \label{e:underdet3}
\frac{d^3x}{dt^3} -\frac{dx}{dt} + 2x = e^{-2t}\sin t + 1.
\end{equation}
The characteristic polynomial of the homogeneous equation associated with 
\eqref{e:underdet3} is $p(\lambda)=\lambda^3-\lambda+2$ and the roots are 
(approximately) $-1.52, 0.76 \pm 0.86i$.  This (numerical) information is
found using \Matlab by typing 
{\tt roots([1 0 -1 2])}\index{\computer!roots}, obtaining
\begin{verbatim}
ans =
  -1.5214       
   0.7607 + 0.8579i     
   0.7607 - 0.8579i
\end{verbatim}

Using Lemma~\ref{L:inhsup} we can find a particular solution to 
\eqref{e:underdet3} by adding together solutions to 
\begin{eqnarray}
\frac{d^3x_1}{dt^3} -\frac{dx_1}{dt} + 2x_1 & = & 1 \label{e:underdet3-1}\\
\frac{d^3x_2}{dt^3} -\frac{dx_2}{dt} + 2x_2 & = & e^{-2t}\sin t 
\label{e:underdet3-2}
\end{eqnarray}

The solution $x_1$ to \eqref{e:underdet3-1} is found by inspection --- the 
annihilator\index{annihilator} of $g_1(t)=1$ is just $D$, 
and the trial space\index{trial!space} consists of 
the constants.  By inspection, the answer is 
\[
x_1(t) = \frac{1}{2}.
\]

To solve \eqref{e:underdet3-2} for $x_2$ we proceed with the three steps 
associated with undetermined coefficients.

\paragraph{Step 1.} The right hand side of \eqref{e:underdet3-2}, 
$g_2(t)=e^{-2t}\sin t$, is a solution of the linear differential equation 
whose characteristic polynomial has roots $-2\pm i$.  Thus, an 
annihilator\index{annihilator} for $g_2$ is:
\begin{equation}  \label{eq:undetcoeffex2}
\frac{d^2y}{dt^2} +4\frac{dy}{dt} +5y = 0.
\end{equation}
To verify this point, observe that the characteristic 
polynomial\index{characteristic polynomial!of higher order ODE} of  
\eqref{eq:undetcoeffex2} is
\[
q(\lambda) = \lambda^2 + 4\lambda +5,
\]
which has roots $-2\pm i$.  

\paragraph{Step 2.} Since the roots of $p$ and $q$ are disjoint sets, the 
trial space\index{trial!space} is the general solution of 
\eqref{eq:undetcoeffex2}, namely,  
\[
y(t) = c_1e^{-2t}\cos t + c_2 e^{-2t}\sin t.
\]
We look for a particular solution to \eqref{e:underdet3-2} in this function 
subspace.

\paragraph{Step 3.} We compute
\begin{eqnarray*}
Dy   & = & e^{-2t}\Big((-2c_1+  c_2)\cos t - (  c_1+2c_2)\sin t\Big)\\
D^2y & = & e^{-2t}\Big(( 3c_1- 4c_2)\cos t + ( 4c_1+3c_2)\sin t\Big)\\
D^3y & = & e^{-2t}\Big((-2c_1+11c_2)\cos t - (11c_1+2c_2)\sin t\Big).
\end{eqnarray*}
Substituting into \eqref{e:underdet3-2} leads to 
\[
e^{-2t}\Big( (2c_1+10c_2)\cos t +(-10c_1+2c_2)\sin t\Big) = 
e^{-2t}\sin t.
\]
Hence $c_1$, $c_2$ satisfy
\begin{eqnarray*}
  2c_1 +10c_2 & = & 0\\
-10c_1 + 2c_2 & = & 1.
\end{eqnarray*}
The solution is $c_1=-\frac{5}{52}$ and $c_2=\frac{1}{52}$, and
the particular solution\index{particular solution} to \eqref{e:underdet3} 
is
\[
x_p(t) = \frac{1}{2} - \frac{5}{52}e^{-2t}\cos t + \frac{1}{52}e^{-2t}\sin t.
\]


\subsubsection*{An Example where $p$ and $q$ have Common Roots}

Consider the first order differential equation
\begin{equation}  \label{E:exer4}
\frac{dx}{dt} - x = e^t.
\end{equation}
The characteristic polynomial of the homogeneous equation is 
$p(\lambda)=\lambda-1$ whose root is $\lambda=1$.  An 
annihilator\index{annihilator} of 
$g(t)=e^t$ is $q(D)=D-1$.  Hence $q(\lambda)$ also has the root $\lambda=1$.
Thus to solve this differential equation by 
undetermined coefficients\index{undetermined coefficients} we
apply $q(D)$ to both sides of the equation, obtaining
\[
q(D) \left(\frac{dx}{dt} - x\right) = \ddot{x} -2\dot{x} +x =0.
\]
Since $\lambda=1$ is a double root for the characteristic polynomial of this 
equation, the general solution is:
\[
x(t) = c_1e^t + c_2te^t.
\]
Setting to zero the solution to the original homogeneous equation (that is, 
setting $c_1=0$), we find that the trial space\index{trial!space}
for the inhomogeneous equation 
\eqref{E:exer4} is
\[
y(t) = c_2te^t.
\] 
Substituting $y(t)$ into \eqref{E:exer4} yields
\[
c_2(e^t + te^t) - c_2te^t = e^t.
\] 
It follows that $c_2=1$ and that $x_p(t) = te^t$ is a particular solution. 
The general solution to \eqref{E:exer4} is:
\[
x(t) = \alpha e^t + te^t.
\]


\EXER

\TEXER

\noindent In Exercises~\ref{c12.4.1a} -- \ref{c12.4.1d} find annihilators 
for each of the given functions.
\begin{exercise}  \label{c12.4.1a}
$g(t) = e^{4t}\cos(5t)$.
\end{exercise}
\begin{exercise}  \label{c12.4.1b}
$g(t) = e^t-1$.
\end{exercise}
\begin{exercise}  \label{c12.4.1c}
$g(t) = t^2e^{2t}$.
\end{exercise}
\begin{exercise}  \label{c12.4.1d}
$g(t) = t\cos(5t)+5\cos(t)$.
\end{exercise}

\noindent In Exercises~\ref{c12.4.1} -- \ref{c12.4.7} use the method of 
undetermined coefficients to find particular solutions to the given 
differential equations.
\begin{exercise}  \label{c12.4.1}
$(D^2-3D+2)x = \sin(t)$.
\end{exercise}
\begin{exercise}  \label{c12.4.2}
$\ddot{x}+2\dot{x}+x = t + e^t$.
\end{exercise}
\begin{exercise}  \label{c12.4.3}
$(D^3+6D^2+9D+4)x = e^{-t}$.
\end{exercise}
\begin{exercise}  \label{c12.4.4}
$(D^2+D-2)x = 3te^t$.
\end{exercise}
\begin{exercise}  \label{c12.4.5}
$\ddot{x}+x = t\sin t$.
\end{exercise}
\begin{exercise}  \label{c12.4.6}
$(D^3+D)x = 6t^2+\sin t$.
\end{exercise}
\begin{exercise}  \label{c12.4.7}
$(D^2+2D+2)x = 8e^{-t}\sin t$.
\end{exercise}

\noindent In Exercises~\ref{c12.4.8}  -- \ref{c12.4.11} solve the given 
initial value problems.
\begin{exercise}  \label{c12.4.8}
$\ddot{x}-x = 1$ where $x(0)=(Dx)(0)=0$.
\end{exercise}
\begin{exercise}  \label{c12.4.9}
$(D^3-8)x = e^{2t}$ where $x(0)=(Dx)(0)=(D^2x)(0)=0$.
\end{exercise}
\begin{exercise}  \label{c12.4.10}
$(D^2+D-6)x = 0$ where $x(0)=(Dx)(0)=0$.
\end{exercise}
\begin{exercise}  \label{c12.4.11}
$(D^2-1)x = 1$ where $x(1)=(Dx)(1)=0$.
\end{exercise}


\end{document}
