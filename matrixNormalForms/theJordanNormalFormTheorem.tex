\documentclass{ximera}

\input{../preamble.tex}

\title{The Jordan Normal Form Theorem}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle


\label{S:JNF}

The question that we discussed in Sections~\ref{S:RDM} and \ref{S:CSE} is: 
Up to similarity, what is the simplest form that a matrix can have?  
We have seen that if $A$ has real distinct eigenvalues, then $A$ is real 
diagonalizable.  That is, $A$ is similar to a diagonal matrix whose 
diagonal entries are the real eigenvalues of $A$.  Similarly, if $A$ has 
distinct real and complex eigenvalues, then $A$ is complex diagonalizable; 
that is, $A$ is similar either to a diagonal matrix whose diagonal entries 
are the real and complex eigenvalues of $A$ or to a real block diagonal 
matrix.

In this section we address the question of simplest form when a
matrix has multiple eigenvalues.  In much of this discussion we assume
that $A$ is an $n\times n$ matrix with only real eigenvalues.  
Lemma~\ref{L:eigenv-diag} shows that if the eigenvectors of 
$A$ form a basis, then $A$ is diagonalizable. Indeed, for $A$ to be
diagonalizable, there must be a basis of eigenvectors of $A$.  It 
follows that if $A$ is not diagonalizable, then $A$ must have fewer
than $n$ linearly independent 
eigenvectors\index{eigenvector!linearly independent}.  

The prototypical examples of matrices having fewer eigenvectors than 
eigenvalues are the matrices $J_n(\lambda)$ for $\lambda$ real (see
\eqref{E:JnR}) and $\widehat{J}_n(\lambda)$ for $\lambda$ complex (see
\eqref{E:JnC}).
\begin{definition} 
A matrix is in {\em Jordan normal form\/} if it is block diagonal and 
the matrix in each block on the diagonal is a Jordan block, that is, 
$J_\ell(\lambda)$ for some integer $\ell$ and some real or complex number 
$\lambda$.  

A matrix is in {\em real Jordan normal form\/} if it is block diagonal 
and the matrix in each block on the diagonal is a real Jordan block, that is, 
either $J_\ell(\lambda)$ for some integer $\ell$ and some real number 
$\lambda$ or $\widehat{J}_\ell(\lambda)$ for some integer $\ell$ and some 
complex number $\lambda$. 
\end{definition} \index{Jordan block}
\index{Jordan normal form}


The main theorem about Jordan normal form is:
\begin{theorem}[Jordan normal form] \label{T:Jordan}
Let $A$ be an $n\times n$ matrix.  Then $A$ is 
similar\index{similar} to a Jordan normal
form matrix and to a real Jordan normal form matrix.
\end{theorem}

This theorem is proved by constructing a basis ${\cal V}$ for $\R^n$ so 
that the matrix $S\inv AS$ is in Jordan normal form, where $S$ is the
matrix whose columns consists of vectors in ${\cal V}$.  The algorithm for 
finding the basis ${\cal V}$ is complicated and is found in 
Appendix~\ref{S:Jordan}.  In this section we construct ${\cal V}$ only in the 
special and simpler case where each eigenvalue of $A$ is real and is 
associated with exactly one Jordan block.

More precisely, let $\lambda_1,\ldots,\lambda_s$ be the distinct 
eigenvalues of $A$ and let 
\[
A_j = A-\lambda_jI_n.
\]   
The eigenvectors corresponding to $\lambda_j$ are the vectors in the
null space\index{null space} of $A_j$ and the 
generalized eigenvectors are the vectors in 
the null space of $A_j^k$ for some $k$.  The dimension of the null space 
of $A_j$ is precisely the number of Jordan blocks\index{Jordan block} 
of $A$ associated to 
the eigenvalue $\lambda_j$.  So the assumption that we make here is 
\[
{\rm nullity}(A_j) = 1
\]
for $j = 1,\ldots,s$.

Let $k_j$ be the integer whose existence is specified by
Lemma~\ref{L:Jordan}.  Since, by assumption, there is only one Jordan block
associated with the eigenvalue $\lambda_j$, it follows that $k_j$ is the
algebraic multiplicity of the eigenvalue $\lambda_j$.

To find a basis in which the matrix $A$ is in Jordan normal 
form\index{Jordan normal form!basis for}, we proceed as follows.  First, let 
$w_{jk_j}$ be a vector in 
\[
\nulls(A_j^{k_j})\setmin\nulls(A_j^{k_j-1}).  
\]  
Define the vectors $w_{ji}$ by 
\begin{eqnarray*}
w_{j,k_j-1} & = & A_jw_{j,k_j} \\
& \vdots &  \\
w_{j,1} & = & A_jw_{j,2}.
\end{eqnarray*}
Second, when $\lambda_j$ is real, let the $k_j$ vectors $v_{ji}=w_{ji}$, and
when $\lambda_j$ is complex, let the $2k_j$ vectors $v_{ji}$ be defined by 
\begin{eqnarray*}
v_{j,2i-1} & = & \RE(w_{ji})\\
v_{j,2i} & = & \IM(w_{ji}). 
\end{eqnarray*}
Let ${\cal V}$ be the set of vectors $v_{ji}\in\R^n$.   We will show in
Appendix~\ref{S:Jordan} that the set ${\cal V}$ consists of $n$ vectors and 
is a basis of $\R^n$.  Let $S$ be the matrix whose columns are the
vectors in ${\cal V}$.  Then $S\inv AS$ is in Jordan normal form.

\subsubsection*{The Cayley Hamilton Theorem}

As a corollary of the Jordan normal form theorem, we prove the Cayley 
Hamilton theorem which states that a {\em square matrix satisfies its 
characteristic polynomial\/}.  More precisely:
\begin{theorem}[Cayley Hamilton] \label{T:CH} \index{Cayley Hamilton theorem}
Let $A$ be a square matrix\index{matrix!square} and let $p_A(\lambda)$ be 
its characteristic polynomial\index{characteristic polynomial}.  Then
\[
p_A(A) = 0.
\]
\end{theorem}

\begin{proof}  Let $A$ be an $n\times n$ matrix.  The characteristic polynomial of 
$A$ is
\[
p_A(\lambda)=\det(A-\lambda I_n).
\]
Suppose that $B=P\inv AP$ is a matrix similar to $A$.  
Theorem~\ref{T:similareigen} states that $p_B=p_A$.  Therefore
\[
p_B(B)= p_A(P\inv AP) = P\inv p_A(A)P.
\]
So if the Cayley Hamilton theorem holds for a matrix similar to $A$, 
then it is valid for the matrix $A$.  Moreover, using the Jordan normal form 
theorem, we may assume that $A$ is in Jordan normal form.  

Suppose that $A$ is block diagonal, that is 
\[
A = \mattwo{A_1}{0}{0}{A_2},
\]
where $A_1$ and $A_2$ are square matrices.  Then 
\[
p_A(\lambda) = p_{A_1}(\lambda)p_{A_2}(\lambda).
\]
This observation follows directly from Lemma~\ref{L:detblockdiag}.  Since
\[
A^k = \mattwoc{A_1^k}{0}{0}{A_2^k},
\]
it follows that 
\begin{align*}
p_A(A) &= \mattwoc{p_A(A_1)}{0}{0}{p_A(A_2)} \\
  &= \mattwoc{p_{A_1}(A_1)p_{A_2}(A_1)}{0}{0}{p_{A_1}(A_2)p_{A_2}(A_2)}.
\end{align*}
It now follows from this calculation that if the Cayley Hamilton theorem is 
valid for Jordan blocks, then $p_{A_1}(A_1)=0=p_{A_2}(A_2)$.  So $p_A(A)=0$ 
and the Cayley Hamilton theorem is valid for all matrices.

A direct calculation shows that Jordan blocks satisfy the 
Cayley Hamilton theorem.  To begin, suppose that the eigenvalue of the 
Jordan block is real.  Note that the characteristic polynomial of 
the Jordan block $J_n(\lambda_0)$ in \eqref{E:JnR} is $(\lambda-\lambda_0)^n$.
Indeed, $J_n(\lambda_0)-\lambda_0I_n$ is strictly upper triangular and 
$(J_n(\lambda_0)-\lambda_0I_n)^n=0$.  If $\lambda_0$ is complex, then either
repeat this calculation using the complex Jordan form or show by direct 
calculation that $(A-\lambda_0I_n)(A-\overline{\lambda_0}I_n)$ is strictly 
upper triangular when $A=\widehat{J}_n(\lambda_0)$ is the real Jordan form of 
the Jordan block in \eqref{E:JnC}.  \end{proof}




\subsection*{An Example}

Consider the $4\times 4$ matrix
\begin{matlabEquation} \label{e:Aexamp}
A=\left(\begin{array}{rrrr}      -147  &  -106      &   -66     &   -488\\
         604   &      432      &   271     &   1992\\
         621   &      448       &  279     &   2063\\
        -169    &    -122      &   -76     &   -562\end{array}\right).
\end{matlabEquation}
Using \Matlab we can compute the characteristic polynomial of $A$
by typing\index{\computer!poly}
\begin{verbatim}
poly(A)
\end{verbatim}
The output is
\begin{verbatim}
ans =
  1.0000   -2.0000  -15.0000   -0.0000   -0.0000
\end{verbatim}
Note that since $A$ is a matrix of integers we know that the coefficients 
of the characteristic polynomial of $A$ must be integers.   Thus the 
characteristic polynomial is exactly:
\[
p_A(\lambda) = \lambda^4-2\lambda^3-15\lambda^2 =
	\lambda^2(\lambda-5)(\lambda+3).
\]
So $\lambda_1=0$ is an eigenvalue of $A$ with 
algebraic multiplicity\index{multiplicity!algebraic} two
and $\lambda_2=5$ and $\lambda_3=-3$ are simple eigenvalues of 
multiplicity one.

We can find eigenvectors of $A$ corresponding to the simple
eigenvalues by typing
\begin{verbatim}
v2 = null(A-5*eye(4));
v3 = null(A+3*eye(4));
\end{verbatim}
At this stage we do not know how many linearly independent
eigenvectors have eigenvalue $0$.  There are either one or two linearly
independent eigenvectors and we determine which by typing {\tt null(A)} 
and obtaining
\begin{verbatim}
ans =
  -0.1818
   0.6365
   0.7273
  -0.1818
\end{verbatim}
So \Matlab tells us that there is just one linearly independent
eigenvector having $0$ as an eigenvalue.  There must be a generalized
eigenvector\index{eigenvector!generalized}
in $V_0$.  Indeed, the null space of $A^2$ is two dimensional
and this fact can be checked by typing
\begin{verbatim}
null2 = null(A^2)
\end{verbatim}
obtaining
\begin{verbatim}
null2 =
    0.2193   -0.2236
   -0.5149   -0.8216
   -0.8139    0.4935
    0.1561    0.1774
\end{verbatim}
Choose one of these vectors, say the first vector, to be $v_{12}$ by typing
\begin{verbatim}
v12 = null2(:,1);
\end{verbatim}
Since the algebraic multiplicity\index{multiplicity!algebraic}
of the eigenvalue $0$ is two, we choose the 
fourth basis vector be $v_{11}=Av_{12}$.  In \Matlab we type 
\begin{verbatim}
v11 = A*v12
\end{verbatim}
obtaining
\begin{verbatim}
v11 =
   -0.1263
    0.4420
    0.5051
   -0.1263
\end{verbatim}
Since {\tt v11} is nonzero, we have found a basis for $V_0$.
We can now put the matrix $A$ in Jordan normal 
form\index{Jordan normal form}
by setting 
\begin{verbatim}
S = [v11 v12 v2 v3];
J = inv(S)*A*S
\end{verbatim}
to obtain
\begin{verbatim}
J = 
   -0.0000    1.0000    0.0000   -0.0000
    0.0000    0.0000    0.0000   -0.0000
   -0.0000   -0.0000    5.0000    0.0000
    0.0000   -0.0000   -0.0000   -3.0000
\end{verbatim}

We have only discussed a Jordan normal form example when the eigenvalues
are real and multiple.  The case when the eigenvalues are complex and 
multiple\index{eigenvalue!complex!multiple} first occurs when $n=4$. 
A sample complex Jordan block when the 
matrix has algebraic multiplicity two eigenvalues $\sigma\pm i\tau$ of 
geometric multiplicity one is
\[
\left(\begin{array}{rrrr} \sigma & -\tau & 1 & 0 \\ 
\tau & \sigma & 0 & 1 \\ 0 & 0 & \sigma & -\tau \\
0 & 0 & \tau & \sigma \end{array}\right).
\]

\subsection*{Numerical Difficulties}

When a matrix has multiple eigenvalues, then numerical difficulties
can arise when using the \Matlab command {\tt eig(A)}, as we now explain.
\index{\computer!eig}

Let $p(\lambda)=\lambda^2$.  Solving $p(\lambda)=0$ is very easy --- in theory
--- as $\lambda=0$ is a double root of $p$.  Suppose, however, that 
we want to solve $p(\lambda)=0$ numerically.  Then, numerical errors 
will lead to solving the equation  
\[
\lambda^2 = \epsilon
\]
where $\epsilon$ is a small number.  Note that if $\epsilon>0$, the 
solutions are $\pm\sqrt{\epsilon}$; while if $\epsilon<0$, the solutions 
are $\pm i\sqrt{|\epsilon|}$.  Since numerical errors are machine 
dependent, $\epsilon$ can be of either sign.  The numerical process of
finding double roots of a characteristic polynomial (that is, double 
eigenvalues of a matrix) is similar to numerically solving the equation 
$\lambda^2=0$, as we shall see.

For example, on a
{\em Sun SPARCstation 10\/} using \Matlab version 4.2c, the eigenvalues 
of the $4\times 4$ matrix $A$ in \eqref{e:Aexamp} (in {\tt format long}) 
obtained using {\tt eig(A)} are:
\begin{verbatim}
ans = 
  5.00000000001021                    
 -0.00000000000007 + 0.00000023858927i
 -0.00000000000007 - 0.00000023858927i
 -3.00000000000993       
\end{verbatim}
That is, \Matlab computes two complex conjugate eigenvalues
\[
\pm 0.00000023858927i
\]
which corresponds to an $\epsilon$ of {\tt -5.692483975913288e-14}.
On a {\em IBM\/} compatible $486$ computer using \Matlab version 4.2
the same computation yields eigenvalues
\begin{verbatim}
ans=
 4.99999999999164
 0.00000057761008
-0.00000057760735
-2.99999999999434
\end{verbatim}
That is, on this computer \Matlab computes two real, near zero, 
eigenvalues 
\[ 
\pm 0.00000057761
\]
that corresponds to an $\epsilon$ of {\tt 3.336333121e-13}. These
errors are within round off error\index{round off error} in 
double precision\index{double precision} computation.

A consequence of these kinds of error, however, is that when a matrix
has multiple eigenvalues, we cannot use the command {\tt [V,D] = eig(A)} 
with confidence. On the {\em Sun SPARCstation\/}, this command yields 
a matrix 

{\scriptsize
\begin{verbatim}
V = 
  -0.1652             0.0000 - 0.1818i   0.0000 + 0.1818i  -0.1642          
   0.6726            -0.0001 + 0.6364i  -0.0001 - 0.6364i   0.6704          
   0.6962            -0.0001 + 0.7273i  -0.0001 - 0.7273i   0.6978          
  -0.1888             0.0000 - 0.1818i   0.0000 + 0.1818i  -0.1915          
\end{verbatim}
\normalsize}

that suggests that $A$ has two complex eigenvectors corresponding 
to the `complex' pair of near zero eigenvalues.  The {\em IBM\/} 
compatible yields the matrix
\begin{verbatim}
V = 
   -0.1652    0.1818   -0.1818   -0.1642
    0.6726   -0.6364    0.6364    0.6704
    0.6962   -0.7273    0.7273    0.6978
   -0.1888    0.1818   -0.1818   -0.1915
\end{verbatim}
indicating that \Matlab has found two real eigenvectors corresponding 
to the near zero real eigenvalues.  Note that the two eigenvectors
corresponding to the eigenvalues $5$ and $-3$ are correct on both 
computers.     

\EXER

\TEXER


\begin{exercise} \label{c10.5.2}
Write two different $4\times 4$ Jordan normal form matrices all
of whose eigenvalues equal $2$ for which the geometric
multiplicity is two.

\begin{solution}

\ans Two such matrices are:
\[
\left(\begin{array}{rrrr}
2 & 1 & 0 & 0 \\
0 & 2 & 0 & 0 \\
0 & 0 & 2 & 1 \\
0 & 0 & 0 & 2 \end{array}\right)
\AND
\left(\begin{array}{rrrr}
2 & 1 & 0 & 0 \\
0 & 2 & 1 & 0 \\
0 & 0 & 2 & 0 \\
0 & 0 & 0 & 2 \end{array}\right)
\]

\end{solution}
\end{exercise}

\begin{exercise} \label{c10.5.2A}
How many different $6\times 6$ Jordan form matrices have all eigenvalues 
equal to $3$? (We say that two Jordan form matrices are the same 
if they have the same number and type of Jordan block, though not
necessarily in the same order along the diagonal.)

\begin{solution}
\ans There are $10$ different Jordan normal form matrices.

\soln  There is $1$ matrix with six Jordan blocks.  There is $1$ matrix with five
Jordan blocks.  There are $2$ matrices with four Jordan blocks; one matrix has a
Jordan block of size three and three blocks of size one and the other matrix has two
Jordan blocks of size two and two of size one.  There are $2$ matrices with three
Jordan blocks; one has a block of size four and one has three blocks of size two.
There are $3$ matrices with two Jordan blocks; one matrix each with a block of
size $n$, where $n=1,2,3$.  There is $1$ Jordan matrix with one Jordan block. 
Altogether, there are $10$ different matrices.

\end{solution}
\end{exercise}

\begin{exercise}  \label{c10.5.2B}
A $5\times 5$ matrix $A$ has three eigenvalues equal
to $4$ and two eigenvalues equal to $-3$.  List the possible Jordan normal 
forms for $A$ (up to similarity).  Suppose that you can ask your computer to
compute the nullity of precisely two matrices.  Can you devise a strategy for
determining the Jordan normal form of $A$?  Explain your answer.

\begin{solution}
\ans There are six different Jordan normal form matrices.

\soln  There are $3$ different Jordan matrices associated with the eigenvalue $4$ and
$2$ different Jordan matrices associated with the eigenvalue $-3$.  Altogether, there
are $3\cdot 2=6$ different Jordan matrices.


\end{solution}
\end{exercise}

\begin{exercise}  \label{c10.5.2C}
An $8\times 8$ real matrix $A$ has three eigenvalues equal to $2$, two 
eigenvalues equal to $1+i$, and one zero eigenvalue.  List the possible 
Jordan normal forms for $A$ (up to similarity).  Suppose that you can ask 
your computer to compute the nullity of precisely two matrices.  Can you 
devise a strategy for determining the Jordan normal form of $A$?  Explain 
your answer.

\begin{solution}
\ans There are $6$ possible Jordan normal form matrices which are
determined by computing nullity$(A-2I_8)$ and nullity$(A-(1+i)I_8)$.

\soln  Since $A$ is real, the eigenvalues of $A$ are $2$ with multiplicity three; 
$1+i$ with multiplicity two; $1-i$ with multiplicity two; and $0$ with multiplicity 
$1$.  There are three possible Jordan blocks associated with the eigenvalues $2$
determined by the geometric multiplicity of the eigenvalue $2$ and two possible Jordan
blocks associated with the eigenvalues $1\pm i$ determined by the geometric
multiplicity of the eigenvalue $1+i$.  The geometric multiplicity of the
eigenvalue $\lambda$ is the dimension of the null space of $A-\lambda I_8$.  Thus 
there are six possible Jordan normal forms and they are determined by computing the
dimensions of $\nulls(A-2I_8)$ and $\nulls(A-(1+i)I_8)$.


\end{solution}
\end{exercise}

\noindent In Exercises~\ref{c10.5.3a} -- \ref{c10.5.4c} find the 
Jordan normal forms for the given matrix.
\begin{exercise} \label{c10.5.3a}
$A = \mattwo{2}{4}{1}{1}$. 

\begin{solution}

\ans The Jordan normal form of matrix $A$ is
\[
\cmattwo{\frac{3 + \sqrt{17}}{2}}{0}{0}{\frac{3 - \sqrt{17}}{2}}.
\]

\soln Matrix $A$ has two distinct real eigenvalues at
$\lambda = \frac{3 + \sqrt{17}}{2}$ and 
$\lambda = \frac{3 - \sqrt{17}}{2}$.

\end{solution}
\end{exercise}
\begin{exercise} \label{c10.5.3b}
$B = \mattwo{9}{25}{-4}{-11}$.

\begin{solution}

\ans The Jordan normal form of matrix $B$ is
\[
\mattwo{-1}{1}{0}{-1}.
\]

\soln Matrix $B$ has one real eigenvalue at $\lambda = -1$ with one
linearly independent eigenvector.

\end{solution}
\end{exercise}
\begin{exercise} \label{c10.5.4}
$C = \left(\begin{array}{rrr} -5 & -8 & -9 \\  5 & 9 & 9 \\
 -1 & -2 & -1 \end{array}\right)$.

\begin{solution}

\ans The Jordan normal form of matrix $C$ is
\[
\matthree{-1}{0}{0}{0}{2}{1}{0}{0}{2}.
\]

\soln Matrix $C$ has two real eigenvalues.  The eigenvalue at $-1$ has
algebraic multiplicity of $1$, and the eigenvalue at $2$ has algebraic
multiplicity of $2$, and only $1$ linearly independent eigenvector.


\end{solution}
\end{exercise}
\begin{exercise} \label{c10.5.4a}
$D = \left(\begin{array}{rrr} 0 & 1 & 0 \\  0 & 0 & 1 \\
1 & 1 & -1 \end{array}\right)$.

\begin{solution}
\ans The Jordan normal form of matrix $D$ is
\[
\matthree{-1}{1}{0}{0}{-1}{0}{0}{0}{1}.
\]

\soln Matrix $D$ has two real eigenvalues.  The eigenvalue at $-1$ has
algebraic multiplicity of $2$ and geometric multiplicity $1$, and the eigenvalue at 
$1$ has multiplicity of $1$.

\end{solution}
\end{exercise}
\begin{exercise} \label{c10.5.4b}
$E = \left(\begin{array}{rrr} 2 & 0 & -1 \\  2 & 1 & -1 \\
1 & 0 & 0 \end{array}\right)$.

\begin{solution}
\ans The Jordan normal form of matrix $E$ is
\[
\matthree{1}{1}{0}{0}{1}{1}{0}{0}{1}.
\]

\soln Matrix $E$ has one eigenvalue at $1$ of algebraic multiplicity of $3$ and 
geometric multiplicity $1$.

\end{solution}
\end{exercise}
\begin{exercise} \label{c10.5.4c}
$F = \left(\begin{array}{rrr} 3 & -1 & 2 \\  -1 & 2 & -1 \\
-1 & 1 & 0 \end{array}\right)$.

\begin{solution}
\ans The Jordan normal form of matrix $F$ is
\[
\matthree{2}{1}{0}{0}{2}{0}{0}{0}{1}.
\]

\soln Matrix $F$ has two real eigenvalues.  The eigenvalue at $2$ has
algebraic multiplicity of $2$ and geometric multiplicity $1$, and the eigenvalue at 
$1$ has multiplicity of $1$.

\end{solution}
\end{exercise}

\begin{exercise}  \label{c10.5.5A}
Compute $e^{tJ}$ where $J=\left(\begin{array}{rrr} 2 & 0 & 0 \\  0 & -1 & 1 \\
0 & 0 & -1 \end{array}\right)$.

\begin{solution}
\ans $e^{tJ} =
\cmatthree{e^t}{0}{0}{0}{e^{-t}}{te^{-t}}{0}{0}{e^{-t}}$.

\soln The matrix $J$ is in block diagonal form so we can compute the matrix exponential 
by computing the matrix exponential of each block.  In particular, let 
\[
M = \mattwo{-1}{1}{0}{-1}.
\]
Then 
\[
e^{tM} = e^{-t}(I_2+tM) = e^{-t}\mattwo{1}{t}{0}{1}.
\]
Therefore,
\[
e^{tJ} = \mattwo{e^t}{0}{0}{e^{tM}} = 
\cmatthree{e^t}{0}{0}{0}{e^{-t}}{te^{-t}}{0}{0}{e^{-t}}.
\]

\end{solution}
\end{exercise}

\begin{exercise}  \label{c10.5.5B}
Compute $e^{tJ}$ where $J=\left(\begin{array}{rrrrr} 2 & 1 & 0 & 0 & 0\\  
0 & 2 & 0 & 0 & 0 \\ 0 & 0 & 3 & 1 & 0\\ 0 & 0 & 0 & 3 & 1\\
0 & 0 & 0 & 0 & 3 \end{array}\right)$.

\begin{solution}
\ans $e^J = 
\cmattwo{e^{2t}\mattwo{1}{t}{0}{1}}{0}{0}{e^{3t}\cmatthree{1}{t}{\frac{1}{2}t^2}{0}{1}{t}{0}{0}{1}}$.

\soln  The matrix $J$ has block diagonal form 
\[
J = \mattwo{L}{0}{0}{M}
\]
where
\[
L = \mattwo{2}{1}{0}{2} \AND M = \matthree{3}{1}{0}{0}{3}{1}{0}{0}{3}.
\]
Therefore,
\[
e^{tJ} = \cmattwo{e^L}{0}{0}{e^M}
\]
where
\[
e^L = e^{2t}\mattwo{1}{t}{0}{1} \AND 
e^M = e^{3t}\cmatthree{1}{t}{\frac{1}{2}t^2}{0}{1}{t}{0}{0}{1}.
\]


\end{solution}
\end{exercise}

\begin{exercise} \label{c10.5.5}
An $n\times n$ matrix $N$ is 
{\em nilpotent\/}\index{nilpotent}\index{matrix!nilpotent} 
if $N^k=0$ for some positive integer $k$.
\begin{itemize}
\item[(a)]  Show that the matrix $N$ defined in \eqref{e:Ndef} is nilpotent.
\item[(b)]  Show that all eigenvalues of a nilpotent matrix equal zero.
\item[(c)]  Show that any matrix similar to a nilpotent matrix is also 
	nilpotent.
\item[(d)]  Let $N$ be a matrix all of whose eigenvalues are zero.  Use 
	the Jordan normal form theorem to show that $N$ is nilpotent.
\end{itemize}

\begin{solution}

(a) The linear map $N^2$ satisfies
\[
N^2e_1 = N^2e_2 = 0, \AND N^2e_j = e_{j - 2}
\mbox{ for } j = 3,\ldots,n.
\]
The linear map $N^3$ satisfies
\[
N^3e_1 = N^3e_2 = N^3e_3 = 0, \AND N^3e_j = e_{j - 3} \mbox{ for }
j = 4,\ldots,n.
\]
By induction, $N^ne_j = 0$ for $j = 1,\dots,n$.  So $N^n = 0$, and $N$
is nilpotent.

(b) Let $\lambda$ be an eigenvalue of matrix $N$.  Then, there
exists a nonzero vector $v$ such that $Nv = \lambda v$.  Therefore,
$N^nv = \lambda^nv$.  If $N$ is nilpotent, then $\lambda^nv = 0$.  Since
$v$ is nonzero, $\lambda^n = 0$, which implies $\lambda = 0$.

(c) Let $M = P^{-1}NP$ be a matrix similar to nilpotent $n \times n$
matrix $N$.  Then $M^n = (P^{-1}NP)^n = P^{-1}N^nP$.  Since $N$ is
nilpotent, $N^n = 0$.  So $M^n = 0$, and $M$ is also nilpotent.

(d) By the Jordan normal form theorem, $N$ is similar to some matrix $W$ which
is block diagonal and has the matrices $N_j$ along the diagonal, where each
$N_j$ is a Jordan block.  By (a) of this problem, $N_j^n = 0$ for each
$j$.  $W^n$ is block diagonal with blocks $N_j^n$.  Since $N_j^n = 0$ for all
$j$, $W^n = 0$.  Thus, $W$ is nilpotent, and, by (c) of this problem, $N$
is also nilpotent.

\end{solution}
\end{exercise}

\begin{exercise} \label{c10.5.5C}
Let $A$ be a $3\times 3$ matrix.  Use the Cayley-Hamilton theorem to show that
$A\inv$ is a linear combination of $I_3,A,A^2$.  That is, there exist real 
scalars $a,b,c$ such that 
\[
A\inv = aI_3 + bA + cA^2.
\]

\begin{solution}

The characteristic polynomial of a $3\times 3$ matrix $A$ has the form 
\[
p_A(\lambda) = -\lambda^3 + b_2\lambda^2 + b_1\lambda + b_0.
\]
The Cayley-Hamilton theorem states that 
\[
p_A(A) = -A^3 + b_2A^2 + b_1A + b_0I_3 = 0.
\]
Therefore
\[
A(-A^2 +b_2A +b_1I_3) = -b_0I_3.
\]
Since $p_A(\lambda) =\det(A-\lambda I_3)$, it follows that $b_0=p_A(0)=\det(A)$.
Since $A$ is invertible, $\det(A)\neq 0$; that is, $b_0\neq 0$.  Finally, 
\[
A\inv = -\frac{1}{b_0}(-A^2+b_2A+b_1I_3) = aI_3 + bA + cA^2,
\]
where $a = -b_1/b_0$, $b = -b_2/b_0$, and $c=1/b_0$.



\end{solution}
\end{exercise}

\CEXER

\noindent In Exercises~\ref{E:jnfma} -- \ref{E:jnfme}, (a) determine the real
Jordan normal form for the given matrix $A$, and (b) find the matrix $S$ so 
that $S\inv AS$ is in real Jordan normal form.  
\begin{exercise}  \label{E:jnfma}
\begin{matlabEquation}\label{jordan-form-exercise}
A = \left(\begin{array}{rrrr} -3 & -4 & -2 & 0\\
-9 & -39 & -16 & -7\\ 18 & 64 & 27 & 10 \\ 15 & 86 & 34 & 18
\end{array}\right). 
\end{matlabEquation}

\begin{solution}

(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrr}
3 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & -1 \end{array}\right).
\]

\soln
To find the Jordan normal form of matrix $A$, type {\tt eig(A)} to find
the eigenvalues.  Matrix $A$ has four distinct eigenvalues, so the
Jordan normal form is the diagonal matrix with these eigenvalues along
its diagonal.  

(b)\ans   The diagonalizing matrix is
\begin{verbatim}
S =
   -0.1387   -0.1543   -0.0000   -0.5774
    0.1387   -0.3086   -0.4082    0.0000
    0.1387    0.9258    0.8165    0.5774
   -0.9707   -0.1543    0.4082   -0.5774
\end{verbatim}

\soln The columns of matrix $S$ consist of the eigenvectors of $A$.


\end{solution}
\end{exercise}
\begin{exercise}  \label{E:jnfmb}
\begin{matlabEquation}\label{jordan-form-exercise-2}
A =\left(\begin{array}{rrrr} 9 & 45 & 18 & 8\\
0 & -4 & -1 & -1\\ -16 & -69 & -29 & -12 \\ 25 & 123 & 49 & 23
\end{array}\right). 
\end{matlabEquation}

\begin{solution}

(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrr}
2 & 0 & 0 & 0 \\
0 & -1 & 1 & 0 \\
0 & 0 & -1 & 1 \\
0 & 0 & 0 & -1 \end{array}\right).
\]

\soln Type {\tt eig(A)} to find the eigenvalues of matrix $A$.  Not all
eigenvalues are simple, so type {\tt null(A - lambda*eye(4))} for each
eigenvalue $\lambda$ to find the number of linearly independent eigenvectors
associated to it.  Matrix $A$ has a simple eigenvalue at $2$, and
an eigenvalue at $-1$ with algebraic multiplicity 3 and one linearly
independent eigenvector.

(b) \ans   The diagonalizing matrix is
\begin{verbatim}
S =
   -0.1387   -0.5902   -1.0165   -0.9837
    0.1387    0.0000   -0.5902    0.1640
    0.1387    0.5902    2.1970    0.0656
   -0.9707   -0.5902   -0.4263    0.0328
\end{verbatim}

\soln The first column of $S$ is $v_1$, the eigenvector associated with
eigenvalue $2$.  To find the other columns, note that the nullity of
$(A + I_4)$ is 1, the nullity of $(A + I_4)^2$ is 2, and the nullity of
$(A + I_4)^3$ is 3.  Then, select one vector from $\null((A + I_4)^3)$
and label it $v_{23}$.  Set $v_{22} = (A + I_4)v_{23}$ and
$v_{21} = (A + I_4)^2v_{23}$.  Then, $S = (v_1|v_{21}|v_{22}|v_{23})$.

\end{solution}
\end{exercise}
\begin{exercise}  \label{E:jnfmc}
\begin{matlabEquation}\label{jordan-form-exercise-3}
A = \left(\begin{array}{rrrr} -5 & -13 & 17 & 42\\
-10 & -57 & 66 & 187\\ -4 & -23 & 26 & 77 \\ -1 & -9 & 9 & 32
\end{array}\right).  
\end{matlabEquation}

\begin{solution}

(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrr}
 0 & 2 &  0 &  0 \\
-2 & 0 &  0 &  0 \\
 0 & 0 & -2 &  1 \\
 0 & 0 & -1 & -2 \end{array}\right).
\]

\soln Type {\tt eig(A)} to find that matrix $A$ has distinct eigenvalues
at $\pm 2i$ and $2 \pm i$.

(b) \ans   The diagonalizing matrix is
\begin{verbatim}
T =
   -0.2118   -0.0456    0.2211    0.0060
   -0.8548   -0.2507    0.8762    0.1803
   -0.3555   -0.0988    0.3529    0.0669
   -0.1437   -0.0531    0.1440    0.0344
\end{verbatim}

\soln The columns of matrix $S$ consist of the eigenvectors of $A$.


\end{solution}
\end{exercise}
\begin{exercise}  \label{E:jnfmd}
\begin{matlabEquation}\label{jordan-form-exercise-4}
A = \left(\begin{array}{rrrr} 1 & 0 & -9 & 18 \\
12 & -7 & -26 & 77\\ 5 & -2 & -13 & 32 \\ 2 & -1 & -4 & 11
\end{array}\right). 
\end{matlabEquation}

\begin{solution}

(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrr}
-2 & 1 & 0 & 0 \\
0 & -2 & 0 & 0 \\
0 & 0 & -2 & 1 \\
0 & 0 & 0 & -2 \end{array}\right).
\]

\soln
Type {\tt eig(A)} to find that $-2$ is the only eigenvalues of $A$.  Then 
type {\tt null(A + 2*eye(4))} to find the number of linearly
independent eigenvectors associated to eigenvalue $\lambda = -2$.  
The eigenvalue has algebraic multiplicity $4$ and geometric multiplicity
$2$.  We then find that the nullity of $(A + 2I_4)^2$ is $4$. 
Therefore, all generalized eigenvectors $v$ of $D$ are in the null space
of $A + 2I_4$.

(b) \ans   The diagonalizing matrix is
\begin{verbatim}
S =
     3     1     0     0
    12     0    -5     1
     5     0    -2     0
     2     0    -1     0
\end{verbatim}

\soln To find $S$, find that $A$ has two linearly independent
eigenvectors associated to $-2$, and that the null space
of $(A + 2I_4)$ is $\R^4$.  Then, select two vectors in $\R^4$, in this
case $v_{12} = (1,0,0,0)^t$ and $v_{22} = (0,1,0,0)^t$, and set
$v_{11} = (A + 2I_4)v_{12}$ and $v_{21} = (A + 2I_4)v_{22}$.  Then,
$S = (v_{11}|v_{12}|v_{21}|v_{22})$.

\end{solution}
\end{exercise}
\begin{exercise} \label{E:jnfme}
\begin{matlabEquation}\label{jordan-form-exercise-5}
A = \left(\begin{array}{rrrr} 
    -1  &  -1  &   1   &  0\\
    -3  &   1  &   1   &  0\\
    -3  &   2  &  -1   &  1\\
    -3  &   2  &   0   &  0
 \end{array}\right). 
\end{matlabEquation}

\begin{solution}

(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrr}
-1 &  1 &  0 & 0 \\
0  & -1 &  1 & 0 \\
0  &  0 & -1 & 0 \\
0  &  0 &  0 & 1 \end{array}\right).
\]

(b) \ans  The diagonalizing matrix is
\begin{verbatim}
S =
    -1     1     0     0
    -1     1     0     1
    -1     0     1     1
    -1     0     0     1
\end{verbatim}

\soln To find $S$, use \Matlab to see that $A$ has two eigenvalues: $-1$ of
algebraic multiplicity three and $2$ of multiplicity one.  The geometric 
multiplicity of $-1$ is one.  Just type {\tt null(A+eye(4))} to see that 
$(1,1,1,1)$ is the only eigenvector corresponding to this eigenvalue.  Choose 
{\tt v3} in the null space of $(A+I_4)^3$ but not in the null space of 
$(A+I_4)^2$.  For example let {\tt v3 = [0 0 1 0]'}.  Then set 
{\tt v2 = (A+eye(4))*v3} and {\tt v1 = (A+eye(4))*v2}.  Finally, set 
{\tt v4 = null(A-2*eye(4))} and {\tt S = [v1 v2 v3 v4]}.

\end{solution}
\end{exercise}
\begin{exercise} \label{E:jnfmf}
\begin{matlabEquation}\label{jordan-form-exercise-6}
A = \left(\begin{array}{rrrrr} 
     0   &  0  &  -1  &   2   &  2\\
     1   & -2  &   0   &  2   &  2\\
     1   & -1  &  -1   &  2   &  2\\
     0   &  0  &   0   &  1   &  2\\
     0   &  0  &   0   & -1   &  3
 \end{array}\right). 
\end{matlabEquation}

\begin{solution}
(a) \ans The Jordan normal form of $A$ is
\[
J = \left(\begin{array}{rrrrr}
-1 &  1 &  0 & 0 &  0 \\
 0 & -1 &  1 & 0 &  0 \\
 0 &  0 & -1 & 0 &  0 \\
 0 &  0 &  0 & 2 & -1 \\
 0 &  0 &  0 & 1 &  2 \end{array}\right).
\]
(b) \ans
\begin{verbatim}
S =
    7.5    6.5      0    2   0
    7.5   -1.0    1.0    2   0
    7.5   -1.0   -6.5    2   0
    0.0    0.0    0.0    2   0
    0.0    0.0    0.0    1   1
\end{verbatim}

\soln  A \Matlab calculation shows that the eigenvalues of $A$ are $-1$ of 
algebraic multiplicity three and geometric multiplicity one and simple 
eigenvalues $2\pm i$.  Choose {\tt v3} in the null space of $(A+I_5)^3$ but not in the null space of 
$(A+I_5)^2$.  One choice is {\tt v3 = [0 1 -6.5 0 0]'}.  Let {\tt v2 = (A+eye(5))*v3}
and {\tt v1 = (A+eye(5))*v2}.  Next, set {\tt v4} equal to the real part of the
eigenvector associated to the eigenvalue $2+i$ and let {\tt v5} be the complex part of
that eigenvector.  Finally, set {\tt S = [v1 v2 v3 v4 v5]}.



\end{solution}
\end{exercise}



\end{document}


