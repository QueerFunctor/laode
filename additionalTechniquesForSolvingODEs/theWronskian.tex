\documentclass{ximera}

\input{../preamble.tex}

\title{The Wronskian}

\begin{document}
\begin{abstract}
\end{abstract}
\maketitle

  \label{S:wronskian}
\index{Wronskian} 

We return to the homogeneous system of linear differential equations
\arraystart
\begin{equation}  \label{eq:linihsys2}
\frac{dX}{dt}  =  A(t)X
\end{equation}
\arrayfinish
where $A(t)=(a_{ij}(t))$ is an $n\times n$ matrix.  Let $X_1,\ldots,X_n$ be a 
linearly independent set of solutions\index{basis!of solutions} 
to \eqref{eq:linihsys2} and let 
\begin{equation}   \label{E:Y(t)2}
Y(t) = \left(X_1(t)|\cdots |X_n(t)\right) 
\end{equation}
Using existence and uniqueness of solutions to the initial problem for
\eqref{eq:linihsys2}, we showed in Lemma~\ref{L:DEspan} that $Y(t)$ is an 
invertible matrix for every time $t$.  In this section we prove this same 
result by explicitly showing that the determinant\index{determinant} 
of $Y(t)$ is always nonzero.

Define the {\em Wronskian\/}\index{Wronskian} to be
\[
W(t) = \det Y(t).
\]

\begin{theorem}  \label{T:Wronskian}
Let $X_1,\ldots,X_n$ be solutions to \eqref{E:NCCH} such that the vectors
$X_j(0)$ form a basis of $\R^n$.  Let $Y(t)$ be the matrix defined in 
\eqref{E:Y(t)}.  Then
\begin{equation}  \label{L:Wronskian}
W(t) = e^{\int_0^t\trace(A(\tau))d\tau}W(0).
\end{equation}
\end{theorem}

It follows directly from \eqref{L:Wronskian} that the determinant of $Y(t)$ is 
nonzero when the determinant of $Y(0)$ is nonzero.  But $\det Y(0)\neq 0$ 
since the vectors $X_j(0)$ form a basis of $\R^n$. 

We prove Theorem~\ref{T:Wronskian} in two important special cases: linear 
constant coefficient systems and linear nonconstant $2\times 2$ systems.  
The proof for constant coefficient systems is based on Jordan normal forms, 
while the proof for $2\times 2$ systems is based on solving a separable 
differential equation for the Wronskian itself.  It is this latter proof 
that generalizes to a proof of the theorem.

\subsubsection*{Wronskians for Constant Coefficient Systems}
\index{Wronskian!constant coefficient system}

First, we interpret the Wronskian directly in terms of the constant coefficient 
matrix $A$.  Note that $X_j(t)=e^{tA}e_j$ is just the $j^{th}$ column of the 
matrix $e^{tA}$.   It follows that 
\[
W(t) = \det e^{tA}.
\]

\begin{lemma} 
Let $A$ be an $n\times n$ matrix.  Then
\[
\det e^A = e^{\trace(A)}.
\]
\end{lemma}\index{determinant}\index{matrix!exponential}
\index{trace}

\begin{proof}  This result is proved using 
Jordan normal forms\index{Jordan normal form}.  To see why normal
form theory is relevant, suppose that $A$ and $B$ are similar matrices.  Then 
$e^A$ and $e^B$ are similar matrices, and $\trace(A)=\trace(B)$ and 
$\det e^A = \det e^B$.  So if we can show that the lemma is valid for matrices 
in Jordan normal form, then the lemma is valid for all matrices.

Suppose that the matrix $J$ is  a $k\times k$ 
Jordan block\index{Jordan block} matrix associated
to the eigenvalue $\lambda$.  Then $J$ is upper triangular and the 
diagonal entries of $J$ all equal $\lambda$.  
It follows that $\trace(J)=k\lambda$.
It also follows that $e^J$ is an upper triangular matrix whose diagonal 
entries all equal $e^\lambda$.  Hence
\[
\det e^J = \left(e^\lambda\right)^k = e^{k\lambda} = e^{\trace(J)}.
\]
So the lemma is valid for Jordan block matrices.

Next suppose that $A$ is in block diagonal\index{matrix!block diagonal}, 
that is
\[
A=\mattwo{B}{0}{0}{C}.
\]
We claim that if the lemma is valid for matrices $B$ and $C$, then it 
is valid for the matrix $A$.  To see this observe that 
\[
\trace(A) = \trace(B) + \trace(C),
\]
and that 
\[
e^A = \mattwo{e^B}{0}{0}{e^C}.
\]
Hence 
\[
\det e^A = \det e^B \det e^C = e^{\trace(B)}e^{\trace(C)}, 
\]
by assumption.  It follows that 
\[
\det e^A = e^{\trace(B)+\trace(C)} = e^{\trace(A)},
\]
as desired.  By induction,  the lemma is valid for Jordan normal form 
matrices and hence for all matrices.  \end{proof}

\subsubsection*{Wronskians for Planar Systems}
\index{Wronskian!planar system}

In the time dependent case we verify Theorem~\ref{T:Wronskian} only 
for $2\times 2$ systems, as this 
substantially simplifies the discussion.   Let 
\[
A(t) = \mattwo{a_{11}(t)}{a_{12}(t)}{a_{21}(t)}{a_{22}(t)},
\]
and let 
\[
X_1(t) = \vectwo{x_1(t)}{y_1(t)} \AND  X_2(t) = \vectwo{x_2(t)}{y_2(t)}
\]
be solutions of \eqref{E:NCCH}.  It follows that 
\begin{equation}   \label{E:xyderiv}
\begin{array}{rcl}
\dot{x}_1 & = & a_{11}x_1 + a_{12}y_1 \\
\dot{y}_1 & = & a_{21}x_1 + a_{22}y_1 \\
\dot{x}_2 & = & a_{11}x_2 + a_{12}y_2 \\
\dot{y}_2 & = & a_{21}x_2 + a_{22}y_2.
\end{array}
\end{equation}

In this notation 
\[
Y(t) = \mattwo{x_1(t)}{x_2(t)}{y_1(t)}{y_2(t)},
\]
and
\[
W(t) = x_1(t)y_2(t) - x_2(t)y_1(t).
\]
We claim that 
\[
\dot{W} = \trace(A) W.
\]
If so, we can use separation of variables to solve this differential equation 
obtaining
\[
\ln |W| = \int \trace(A(t))dt 
\]
from which the proof of Theorem~\ref{T:Wronskian} follows.

Use the product rule to compute
\[
\dot{W}  =  \dot{x}_1y_2 + x_1\dot{y}_2 - \dot{x}_2y_1 - x_2\dot{y}_1.
\]
Now substitute \eqref{E:xyderiv} to see that 
\[
\dot{W} = (a_{11}x_1 + a_{12}y_1)y_2 + x_1(a_{21}x_2 + a_{22}y_2)
- (a_{11}x_2 + a_{12}y_2)y_1 - x_2(a_{21}x_1 + a_{22}y_1)
\]
from which it follows that 
\[
\dot{W} = (a_{11}+a_{22})W = \trace(A)W,
\]
as claimed.


\EXER

\TEXER

In Exercises~\ref{c14.4.1a} -- \ref{c14.4.1d} compute the Wronskian
$W(t)$ for the specified matrices:

\begin{exercise} \label{c14.4.1a}
$Y(t) = \mattwo{t}{1}{-1}{t}$.

\begin{solution}
\ans The Wronskian is $W(t) = t^2 + 1$.

\soln $W(t) = \det(Y(t)) = \det\mattwo{t}{1}{-1}{t} = t^2 + 1$.

\end{solution}
\end{exercise}

\begin{exercise} \label{c14.4.1b}
$Y(t) = \mattwo{\cos t}{-\sin t}{\sin t}{\cos t}$.

\begin{solution}
\ans The Wronskian is $W(t) = 1$.

\soln $W(t) = \det(Y(t)) = \det\mattwo{\cos t}{-\sin t}{\sin t}{\cos t} =
\cos^2 t + \sin^2 t = 1$.

\end{solution}
\end{exercise}

\begin{exercise} \label{c14.4.1c}
$Y(t) = \left(\begin{array}{ccc}
0 & t & e^t\\  1 & t & te^t \\ t & t & t^2 e^t \end{array}\right)$.

\begin{solution}
\ans The Wronskian is $W(t) = te^t(1 - t)$.

\soln
\[
W(t) = \det(Y(t)) = \det\cmatthree{0}{t}{e^t}{1}{t}{te^t}{t}{t}{t^2e^t}
= te^t - t^2e^t.
\]

\end{solution}
\end{exercise}

\begin{exercise} \label{c14.4.1d}
$Y(t) = \left(\begin{array}{ccc}
1 & 0 & 1\\  1 + \sin t & 1 & e^t \\ -4 + \cos t & t & te^t 
\end{array}\right)$.

\begin{solution}
\ans The Wronskian is $W(t) = t + t\sin t - \cos t + 4$.

\soln
\[
W(t) = \det(Y(t)) =
\det\cmatthree{1}{0}{1}{1 + \sin t}{1}{e^t}{-4 + \cos t}{t}{te^t} =
t + t\sin t - \cos t + 4.
\]

\end{solution}
\end{exercise}

\begin{exercise}  \label{c14.w.2}
Use \eqref{L:Wronskian} to verify that the Wronskian for solutions to the linear 
constant coefficient system of ODE $\dot{X}=AX$ is
\begin{equation}  \label{E:ccw}
W(t) = e^{\trace(A)t}W(0).
\end{equation}

\begin{solution}
Equation \eqref{L:Wronskian}
states that the Wronskian for solutions to $\dot{X} = AX$ is
\[
W(t) = e^{\int_0^t\trace(A(\tau))d\tau}W(0).
\]
If $\dot{X} = AX$ is a linear constant coefficient system, then $A$ is not
time-dependent, so $\trace(A(t)) = \trace(A)$ for all $t$.  Thus,
\[
\int_0^t\trace(A(\tau))d\tau = \int_0^t\trace(A)d\tau = \trace(A)t,
\]
and $W(t) = e^{\trace(A)t}W(0)$, as desired.

\end{solution}
\end{exercise}

\noindent In Exercises~\ref{c14.w.3a} -- \ref{c14.w.3c} verify \eqref{E:ccw} 
for the given matrix $A$.  {\bf Hint:} First, you need to find linearly 
independent solutions to the system $\dot{X}=AX$.
\begin{exercise} 	\label{c14.w.3a}
$A = \mattwo{0}{-1}{1}{0}$.

\begin{solution}
\ans The Wronskian is $W(t) = 1$.

\soln First, find that $A$ has an eigenvalue $\lambda = i$ with corresponding
eigenvector $v = (1,-i)^t$.  Thus, the vectors $X_1(t) = (\cos t, \sin t)^t$
and $X_2(t) = (-\sin t, \cos t)^t$ are linearly independent solutions to
$\dot{X} = AX$.  So the matrix whose columns are solutions to this system
is
\[
Y(t) = \mattwo{\cos t}{-\sin t}{\sin t}{\cos t}.
\]
Compute the right hand side of \eqref{E:ccw}:
\[
W(t) = e^{\trace(A)t}W(0) = e^0\det(Y(0)) = 1.
\]
To verify that this result is correct, compute the left hand side of
\eqref{E:ccw} by definition of the Wronskian:
\[
W(t) = \det(Y(t)) = \cos^2 t + \sin^2 t = 1.
\]

\end{solution}
\end{exercise}
\begin{exercise} 	\label{c14.w.3b}
$A = \mattwo{2}{3}{3}{2}$.

\begin{solution}
\ans The Wronskian is $W(t) = -2e^{4t}$.

\soln First, find that $A$ has eigenvalues $\lambda_1 = 5$ and
$\lambda_2 = -1$ with corresponding eigenvectors $v_1 = (1,1)^t$ and
$v_2 = (1,-1)^t$.  Thus, the vectors $X_1(t) = e^{5t}(1,1)^t$ and
$X_2(t) = e^{-t}(1,-1)^t$ are linearly independent solutions to
$\dot{X} = AX$.  So the matrix whose columns are solutions to this
system is
\[
Y(t) = \mattwo{e^{5t}}{e^{-t}}{e^{5t}}{-e^{-t}}.
\]
Compute the right hand side of \eqref{E:ccw}:
\[
W(t) = e^{\trace(A)t}W(0) = e^{4t}\det(Y(0)) = -2e^{4t}.
\]
To verify that this result is correct, compute the left hand side of
\eqref{E:ccw} by definition of the Wronskian:
\[
W(t) = \det(Y(t)) = -2e^{4t}.
\]

\end{solution}
\end{exercise}
\begin{exercise} 	\label{c14.w.3c}
$A = \mattwo{2}{-2}{4}{-3}$.

\begin{solution}
\ans The Wronskian is $W(t) = -4\sqrt{7}e^{-t}$.

\soln First, find that $A$ has an eigenvalue $\lambda =
\frac{1}{2}(-1 + \sqrt{7}i$ with corresponding
eigenvector $v = (4,5 - \sqrt{7}i)^t$.  Thus, the vectors
\[
\begin{array}{rcl}
X_1(t) & = & e^{-\frac{1}{2}t}\cvectwo{4\cos\left(\frac{\sqrt{7}}{2}t\right)}
{5\cos\left(\frac{\sqrt{7}}{2}t\right) +
\sqrt{7}\sin\left(\frac{\sqrt{7}}{2}t\right)} \\
X_2(t) & = & e^{-\frac{1}{2}t}\cvectwo{4\sin\left(\frac{\sqrt{7}}{2}t\right)}
{5\sin\left(\frac{\sqrt{7}}{2}t\right) -
\sqrt{7}\cos\left(\frac{\sqrt{7}}{2}t\right)}
\end{array}
\]
are linearly independent solutions to $\dot{X} = AX$.  So the matrix
whose columns are solutions to this system is
\[
Y(t) = e^{-\frac{1}{2}t}\cmattwo{4\cos\left(\frac{\sqrt{7}}{2}t\right)}
{4\sin\left(\frac{\sqrt{7}}{2}t\right)}
{5\cos\left(\frac{\sqrt{7}}{2}t\right) +
\sqrt{7}\sin\left(\frac{\sqrt{7}}{2}t\right)}
{5\sin\left(\frac{\sqrt{7}}{2}t\right) -
\sqrt{7}\cos\left(\frac{\sqrt{7}}{2}t\right)}.
\]
Compute the right hand side of \eqref{E:ccw}:
\[
W(t) = e^{\trace(A)t}W(0) = e^{-t}\det(Y(0)) = -4\sqrt{7}e^{-t}.
\]
To verify that this result is correct, compute the left hand side of
\eqref{E:ccw} by definition of the Wronskian:
\[
W(t) = \det(Y(t)) = -4\sqrt{7}e^{-t}.
\]




\end{solution}
\end{exercise}

 


\end{document}
